{% extends 'base.html.twig' %}

{% block title %}Edit Time Entry - Ticket #{{ ticket.id }}{% endblock %}

{% block body %}
<div class="container py-4">
    {# Back Button #}
    <div class="mb-3">
        <a href="{{ path('app_ticket_show', {
            'organizationSlug': organization.slug,
            'ticketId': ticket.id
        }) }}" class="btn btn-sm btn-outline-secondary">
            <i class="bi bi-arrow-left"></i>
            Back to Ticket
        </a>
    </div>

    {# Page Header #}
    <div class="mb-4">
        <h2>
            <i class="bi bi-pencil"></i>
            Edit Time Entry
        </h2>
        <p class="text-muted">
            Ticket #{{ ticket.id }}: {{ ticket.title }}
        </p>
    </div>

    {# Form Card #}
    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">Time Entry Details</h5>
        </div>
        <div class="card-body">
            {{ form_start(form) }}
                <div class="row g-3">
                    <div class="col-md-12">
                        {{ form_label(form.description, null, {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.description, {'attr': {'class': 'form-control', 'rows': 3, 'placeholder': 'Describe the work performed...'}}) }}
                        {{ form_errors(form.description) }}
                    </div>

                    <div class="col-md-6">
                        {{ form_label(form.hours, null, {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.hours, {'attr': {'class': 'form-control', 'placeholder': 'e.g., 1.5'}}) }}
                        {{ form_errors(form.hours) }}
                        <small class="text-muted">
                            <i class="bi bi-info-circle"></i>
                            Billed hours will be rounded up to nearest 0.5h
                        </small>
                    </div>

                    <div class="col-md-6">
                        {{ form_label(form.workDate, null, {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.workDate, {'attr': {'class': 'form-control'}}) }}
                        {{ form_errors(form.workDate) }}
                    </div>
                </div>

                {# Original Billing Info (Read-only) #}
                <div class="alert alert-warning mt-3">
                    <strong>Original Hourly Rate:</strong> {{ timeEntry.hourlyRateSnapshot|number_format(2) }} â‚¬/h
                    <br>
                    <small class="text-muted">
                        <i class="bi bi-lock"></i>
                        The hourly rate is locked and will not change when editing
                    </small>
                </div>

                <div class="d-flex gap-2 mt-4">
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-check-circle"></i>
                        Update Time Entry
                    </button>
                    <a href="{{ path('app_ticket_show', {
                        'organizationSlug': organization.slug,
                        'ticketId': ticket.id
                    }) }}" class="btn btn-secondary">
                        Cancel
                    </a>
                </div>
            {{ form_end(form) }}
        </div>
    </div>
</div>
{% endblock %}
